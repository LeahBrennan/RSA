'''
n = 798321817573328185527
6461076134959298461474443
2279135328398999801627880
283610900361281249973175
805069916210179560506497
07513252490208688112037221
3626641879468491936860976686933630869
673826972619938321951599146744
8076533010760265779495796183
3150277630398348556604648543103
954170846714140826022009859276
124501067859234750189417626958051
045972963367346806846714419974456373
18263621026088110334008878137547802826280994
43490170016087838606998017490456601315802
448567772411623826281747245660954245413
7815197942953361975556885435379921971422
5805322045375766653784027641647560275937
4950715283890232230741542737319569819793988431443

'''

p = 3133337
'''
http://factordb.com/index.php?query=7983218175733281855276461
07613495929846147444322791353283989998016278802836109003612812
49973175805069916210179560506497075132524902086881120372213626
64187946849193686097668693363086967382697261993832195159914674
48076533010760265779495796183315027763039834855660464854310395
41708467141408260220098592761245010678592347501894176269580510
45972963367346806846714419974456373182636210260881103340088781
37547802826280994434901700160878386069980174904566013158024485
67772411623826281747245660954245413781519794295336197555688543
53799219714225805322045375766653784027641647560275937495071528
3890232230741542737319569819793988431443
 -> 
 http://factordb.com/index.php?id=3133337
'''


q =  25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939

'''
http://factordb.com/index.php?query=7983218175733281855276
4610761349592984614744432279135328398999801627880283610900
3612812499731758050699162101795605064970751325249020868811
2037221362664187946849193686097668693363086967382697261993
8321951599146744807653301076026577949579618331502776303983
4855660464854310395417084671414082602200985927612450106785
9234750189417626958051045972963367346806846714419974456373
1826362102608811033400887813754780282628099443490170016087
8386069980174904566013158024485677724116238262817472456609
5424541378151979429533619755568854353799219714225805322045
3757666537840276416475602759374950715283890232230741542737
319569819793988431443
 ->
http://factordb.com/index.php?id=1100000000803069598

'''


n = p*q
phi = (p-1)*(q-1)

# Took from SO -ofaurax
def egcd2(a, b):
    if a == 0:
        return (b, 0, 1)
    g, y, x = egcd2(b%a,a)
    return (g, x - (b//a) * y, y)

def modinv(a, m):
    g, x, y = egcd2(a, m)
    if g != 1:
        raise Exception('No modular inverse')
    return x%m

e = 65537

d = modinv(e, phi)

print('P =', p)
print('Q =', q)
print('N =', n)
print('Phi =', phi)
print('E =', e)
print('D =', d)
print('(E*D)%Phi =', (e*d)%phi)
